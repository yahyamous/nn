
-- ÙˆØ¥Ù„Ø§ ÙŠÙ‚ÙˆÙ… Ø¨Ù…Ø³Ø­ Ù…Ø­Ù„ÙŠ ÙˆØ¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± Ø¥Ù„Ù‰ Webhook (Ø¥Ø°Ø§ ÙˆØ¶Ø¹Øª WEBHOOK Ù…Ø­Ù„ÙŠÙ‹Ø§).
-- Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø§ ØªØ±ÙØ¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø¥Ù„Ù‰ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¹Ø§Ù….

local HttpService = game:GetService("HttpService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")

-- Ø¥Ù† Ø£Ø±Ø¯Øª Ø£Ù† ÙŠØ¹ØªÙ…Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ Ø¶Ø¹ Ù‡Ù†Ø§ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ (Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·).
local WEBHOOK = "" -- Ø¶Ø¹ Ø±Ø§Ø¨Ø·Ùƒ Ù‡Ù†Ø§ Ø¥Ù† Ø£Ø±Ø¯Øª Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ (Ø¥Ù„Ø§ Ø¥Ù† ÙƒØ§Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø³ÙŠØ±Ø³Ù„Ù‡)

-- Ø§Ø³Ù… Ø§Ù„Ù€ RemoteEvent ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø°ÙŠ Ø£Ø¹Ø·ÙŠØªÙƒ Ø³Ø§Ø¨Ù‚Ø§Ù‹
local REMOTE_NAME = "AdminRequestReport"

-- Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¥Ø±Ø³Ø§Ù„ HTTP Ø¹Ø¨Ø± Ø¯ÙˆØ§Ù„ Executors Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
local function post_json_executor(url, body)
    if not url or url == "" then return false, "no url" end
    local headers = { ["Content-Type"] = "application/json" }

    if type(syn) == "table" and type(syn.request) == "function" then
        local ok, res = pcall(function() return syn.request({ Url = url, Method = "POST", Headers = headers, Body = body }) end)
        if ok and res and (res.StatusCode == 200 or res.StatusCode == 204 or res.StatusCode == 201) then return true, res end
    end

    if type(request) == "function" then
        local ok, res = pcall(function() return request({ Url = url, Method = "POST", Headers = headers, Body = body }) end)
        if ok and res and (res.StatusCode == 200 or res.StatusCode == 204 or res.StatusCode == 201) then return true, res end
    end

    if type(http) == "table" and type(http.request) == "function" then
        local ok, res = pcall(function() return http.request({ Url = url, Method = "POST", Headers = headers, Body = body }) end)
        if ok and res and (res.StatusCode == 200 or res.StatusCode == 204 or res.StatusCode == 201) then return true, res end
    end

    if type(http_request) == "function" then
        local ok, res = pcall(function() return http_request({ Url = url, Method = "POST", Headers = headers, Body = body }) end)
        if ok and res and (res.StatusCode == 200 or res.StatusCode == 204 or res.StatusCode == 201) then return true, res end
    end

    -- HttpService:PostAsync Ù‚Ø¯ Ù„Ø§ ÙŠØ¹Ù…Ù„ ÙÙŠ Ù…Ø¹Ø¸Ù… executorsØŒ Ù„ÙƒÙ† Ù†Ø¬Ø±Ù‘Ø¨ ÙƒØ®ÙŠØ§Ø± Ø£Ø®ÙŠØ±
    if HttpService and HttpService.HttpEnabled then
        local ok, res = pcall(function() return HttpService:PostAsync(url, body, Enum.HttpContentType.ApplicationJson) end)
        if ok and res then return true, res end
    end

    return false, "no http method available"
end

-- Ø¯Ø§Ù„Ø© Ù…Ø³Ø­ Ù…Ø­Ù„ÙŠ Ø¨Ø³ÙŠØ·Ø© Ù„Ù‚Ø±Ø§Ø¡Ø© workspace.Animals Ø¥Ù† ÙƒØ§Ù†Øª Ù…Ø±Ø¦ÙŠØ©
local function local_scan()
    local folder = workspace:FindFirstChild("Animals") or workspace:FindFirstChild("Brainrots")
    if not folder then
        return nil, "Ù„Ù… Ø£Ø¬Ø¯ Ù…Ø¬Ù„Ø¯ 'Animals' Ø£Ùˆ 'Brainrots' ÙÙŠ workspace (Ù‚Ø¯ ÙŠÙƒÙˆÙ† Server-only ÙˆØºÙŠØ± Ù…Ø±Ø¦ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„)."
    end

    local items = {}
    for _, v in ipairs(folder:GetChildren()) do
        if v:IsA("Model") then
            local name = tostring(v.Name or "ØºÙŠØ± Ù…Ø³Ù…Ù‘Ù‰")
            local price = 0
            local mutation = "None"
            local rarity = "Unknown"

            local p = v:FindFirstChild("Price")
            if p then pcall(function() price = tonumber(p.Value) or p.Value or 0 end) end
            local mut = v:FindFirstChild("Mutation")
            if mut then pcall(function() mutation = tostring(mut.Value or "None") end) end
            local rar = v:FindFirstChild("Rarity")
            if rar then pcall(function() rarity = tostring(rar.Value or "Unknown") end) end

            table.insert(items, { name = name, price = price, mutation = mutation, rarity = rarity })
        end
    end

    return items
end

-- Ø¨Ù†Ø§Ø¡ Embed Ø¨Ø³ÙŠØ· ÙƒÙ†Øµ JSON Ù„Ø§Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Discord (ØµÙŠØºØ© Ù…ØµØºØ±Ø©)
local function build_embed_payload(items)
    table.sort(items, function(a,b) return (a.price or 0) > (b.price or 0) end)
    local top = {}
    for i = 1, math.min(10, #items) do
        local it = items[i]
        table.insert(top, string.format("%d. %s â€” ğŸ’° %s â€” ğŸ§¬ %s â€” â­ %s", i, it.name, tostring(it.price), it.mutation, it.rarity))
    end
    local serverLink = "https://www.roblox.com/games/" .. tostring(game.PlaceId)
    local desc = string.format("[Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…](%s) â€¢ Ù…ÙØ¹Ø±Ù‘Ù Ø§Ù„Ø¬ÙˆØ¨: `%s`", serverLink, tostring(game.JobId))
    local embed = {
        title = "ğŸ›° ØªÙ‚Ø±ÙŠØ± Ù…Ø³Ø­ (Executor Local)",
        description = desc,
        color = 65311,
        fields = {
            { name = "ğŸ¾ Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ±", value = tostring(#items), inline = true },
            { name = "ğŸ† Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù†Ø§ØµØ±", value = table.concat(top, "\n"), inline = false }
        },
        timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
    }
    local payload = { embeds = { embed } }
    return HttpService:JSONEncode(payload)
end

-- Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: Ø£ÙˆÙ„Ø§Ù‹ Ø§Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø¥Ù† ÙˆÙØ¬Ø¯ RemoteEventØŒ ÙˆØ¥Ù„Ø§ Ø§ÙØ¹Ù„ Ù…Ø³Ø­Ø§Ù‹ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙˆØ­Ø§ÙˆÙ„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
local function main()
    -- 1) Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„ÙŠÙ‚ÙˆÙ… Ù‡Ùˆ Ø¨Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (Ø§Ù„Ø£ÙØ¶Ù„)
    local remote = ReplicatedStorage:FindFirstChild(REMOTE_NAME)
    if remote and remote:IsA("RemoteEvent") then
        -- Ù†Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨Ø› Ø§Ù„Ø®Ø§Ø¯Ù… Ø³ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø·Ù„Ø¨ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‡Ùˆ CreatorId (ÙƒÙ…Ø§ ØµÙÙ…Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª)
        local player = Players.LocalPlayer
        if not player then
            warn("Ù„Ø§ ÙŠÙˆØ¬Ø¯ LocalPlayer (Ø±Ø¨Ù…Ø§ ØªØ¹Ù…Ù„ ÙÙŠ Ø¨ÙŠØ¦Ø© Ù„Ø§ ØªØ¯Ø¹Ù… ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨).")
        else
            -- Ù†Ø³ØªÙ…Ø¹ Ù„Ø±Ø¯ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¥Ù† ÙˆÙØ¬Ø¯
            local conn
            conn = remote.OnClientEvent:Connect(function(data)
                -- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: { success = true/false, message = "..." }
                if data and type(data) == "table" then
                    if data.success then
                        print("[Executor] Ø§Ù„Ø®Ø§Ø¯Ù… Ø£ÙƒØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±: " .. tostring(data.message or "ØªÙ…"))
                    else
                        warn("[Executor] Ø§Ù„Ø®Ø§Ø¯Ù… Ø£Ø¹Ø§Ø¯ Ø®Ø·Ø£: " .. tostring(data.message or "Ø®Ø·Ø£"))
                    end
                end
                if conn then conn:Disconnect() end
            end)
            -- Ø£Ø±Ø³Ù„ Ø§Ù„Ø·Ù„Ø¨
            pcall(function() remote:FireServer("send") end)
            print("[Executor] ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± (Ø¥Ù† ÙƒÙ†Øª ØµØ§Ø­Ø¨ Ø§Ù„Ù„Ø¹Ø¨Ø©).")
            return
        end
    end

    -- 2) Ø¥Ù† Ù„Ù… ÙŠÙˆØ¬Ø¯ RemoteEvent Ø£Ùˆ LocalPlayerØŒ Ù†Ù‚ÙˆÙ… Ø¨Ù…Ø³Ø­ Ù…Ø­Ù„ÙŠ ÙˆÙ†Ø­Ø§ÙˆÙ„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ (ÙŠØªØ·Ù„Ø¨ ÙˆØ¶Ø¹ WEBHOOK Ù…Ø­Ù„ÙŠØ§Ù‹)
    local items, err = local_scan()
    if not items then
        warn("[Executor] Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ù„ÙŠ ÙØ´Ù„: " .. tostring(err))
        return
    end
    if #items == 0 then
        print("[Executor] Ù„Ù… ØªÙØ¹Ø«Ø± Ø£ÙŠ Ø¹Ù†Ø§ØµØ± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ù„ÙŠ. Ø±Ø¨Ù…Ø§ Ø§Ù„Ø¹Ù†Ø§ØµØ± Server-only.")
        return
    end

    if not WEBHOOK or WEBHOOK == "" then
        warn("[Executor] Ù„Ø§ ÙŠÙˆØ¬Ø¯ WEBHOOK Ù…ÙØ¹Ø¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù…Ø­Ù„ÙŠØ§Ù‹. Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ ÙÙŠ Ù…ØªØºÙŠØ± WEBHOOK Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù.")
        -- Ø¨Ø¯Ù„Ù‹Ø§ Ù…Ù† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ Ù†Ø·Ø¨Ø¹ Ù…Ù„Ø®Ù‘ØµÙ‹Ø§ ÙÙŠ Console
        print("[Executor] Ù…Ù„Ø®Ù‘Øµ Ø§Ù„Ø¹Ù†Ø§ØµØ±:")
        for i, it in ipairs(items) do
            print(string.format("%d) %s â€” Price=%s â€” Mutation=%s â€” Rarity=%s", i, it.name, tostring(it.price), it.mutation, it.rarity))
        end
        return
    end

    local body = build_embed_payload(items)
    local ok, res = post_json_executor(WEBHOOK, body)
    if ok then
        print("[Executor] ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¹Ø¨Ø± WEBHOOK Ø¨Ù†Ø¬Ø§Ø­.")
    else
        warn("[Executor] ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±: " .. tostring(res))
    end
end

-- Ù†ÙÙ‘Ø°
pcall(main)
